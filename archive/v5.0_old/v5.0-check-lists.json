{
    "version": "5.0.0",
    "last_updated": "2025-10-05T17:40:33.001348",
    "description": "小柳系统v5.0检查清单 - 整合v3.0检查清单 + v4.3工作流程检查",
    "usage": "每次执行关键操作前，必须先执行对应的检查清单，确保不遗漏规则",
    "check_lists": {
        "开发代码前检查清单": {
            "trigger_keywords": [
                "开发",
                "写代码",
                "实现功能",
                "编写",
                "创建功能"
            ],
            "check_items": [
                {
                    "id": "CHK-DEV-001",
                    "rule_ref": "IR-010",
                    "question": "是否检查了模块/功能是否已存在？",
                    "how_to_check": "搜索代码库、查看模块注册表、询问用户",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-002",
                    "rule_ref": "IR-023",
                    "question": "是否设计了清晰的调用接口？",
                    "how_to_check": "接口参数、返回值、说明文档是否完整",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-003",
                    "rule_ref": "IR-008",
                    "question": "是否避免了硬编码，使用配置变量？",
                    "how_to_check": "代码中是否有固定的数字、路径、字符串等",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-004",
                    "rule_ref": "用户偏好-5992831",
                    "question": "注释是否使用中文并以 // 结尾？",
                    "how_to_check": "检查注释格式是否符合 Key Spirit 风格",
                    "violation_risk": "medium",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-005",
                    "rule_ref": "用户偏好-4459846",
                    "question": "延迟是否使用统一延迟算法而非单独定义？",
                    "how_to_check": "是否有多个独立的延迟变量",
                    "violation_risk": "medium",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-006",
                    "rule_ref": "IR-011",
                    "question": "函数是否控制在300行以内？",
                    "how_to_check": "预估函数规模，是否需要拆分",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-007",
                    "rule_ref": "IR-009",
                    "question": "命名是否清晰且遵循驼峰/下划线规范？",
                    "how_to_check": "变量、函数、类名是否有意义",
                    "violation_risk": "medium",
                    "must_pass": true
                },
                {
                    "id": "CHK-DEV-008",
                    "rule_ref": "IR-013",
                    "question": "是否设计了完整的错误处理？",
                    "how_to_check": "try-catch、错误返回值、日志记录",
                    "violation_risk": "high",
                    "must_pass": true
                }
            ],
            "auto_remind_template": "收到！开始开发前我会先检查：\n✅ 模块是否已存在(IR-010)\n✅ 接口设计(IR-023)\n✅ 避免硬编码(IR-008)\n✅ 中文注释//(用户偏好)\n✅ 统一延迟算法(用户偏好)\n开始开发..."
        },
        "测试代码前检查清单": {
            "trigger_keywords": [
                "测试",
                "运行",
                "验证",
                "检查功能"
            ],
            "check_items": [
                {
                    "id": "CHK-TEST-001",
                    "rule_ref": "IR-020",
                    "question": "是否准备了三重验证（日志+截图+执行）？",
                    "how_to_check": "日志输出、截图保存、实际执行验证",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-TEST-002",
                    "rule_ref": "IR-015",
                    "question": "测试前是否关闭了其他应用？",
                    "how_to_check": "清理测试环境，避免干扰",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-TEST-003",
                    "rule_ref": "IR-016",
                    "question": "是否设置了超时保护机制？",
                    "how_to_check": "测试代码是否有时间限制和最大执行次数",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-TEST-004",
                    "rule_ref": "IR-016",
                    "question": "是否避免了无限循环？",
                    "how_to_check": "所有循环是否有明确的退出条件和最大次数",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-TEST-005",
                    "rule_ref": "IR-021",
                    "question": "是否准备了5轮完整流程测试？",
                    "how_to_check": "测试计划是否包含5次从0-1的完整测试",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-TEST-006",
                    "rule_ref": "项目规范",
                    "question": "测试环境是否正确（模拟器/分辨率/内存）？",
                    "how_to_check": "小遥安卓模拟器、1280x720、4GB+RAM",
                    "violation_risk": "high",
                    "must_pass": true
                }
            ],
            "auto_remind_template": "收到！测试前我会确认：\n✅ 三重验证准备(IR-020)\n✅ 关闭其他应用(IR-015)\n✅ 超时保护机制(IR-016)\n✅ 避免无限循环(IR-016)\n✅ 5轮完整测试(IR-021)\n开始测试..."
        },
        "修改代码前检查清单": {
            "trigger_keywords": [
                "修复",
                "修改",
                "改",
                "fix",
                "修复bug"
            ],
            "check_items": [
                {
                    "id": "CHK-FIX-001",
                    "rule_ref": "IR-012",
                    "question": "是否只修改错误位置的代码？",
                    "how_to_check": "不修改非错误代码，不顺便优化",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-FIX-002",
                    "rule_ref": "IR-018",
                    "question": "如果BUG修复失败超过5次，是否换方法？",
                    "how_to_check": "尝试次数计数，超过5次搜索新方案",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-FIX-003",
                    "rule_ref": "失败教训库",
                    "question": "是否查阅了历史BUG修复经验？",
                    "how_to_check": "搜索失败教训库中的类似问题",
                    "violation_risk": "medium",
                    "must_pass": false
                },
                {
                    "id": "CHK-FIX-004",
                    "rule_ref": "IR-022",
                    "question": "是否识别了多场景兼容性问题？",
                    "how_to_check": "问题是否在多种语言/位置/字体下都会出现",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-FIX-005",
                    "rule_ref": "IR-017",
                    "question": "是否优先考虑热修改方式？",
                    "how_to_check": "代码是否支持运行时修改和继续",
                    "violation_risk": "medium",
                    "must_pass": false
                }
            ],
            "auto_remind_template": "收到！修复前我会注意：\n✅ 只改错误位置(IR-012)\n✅ 5次失败换方法(IR-018)\n✅ 查阅历史经验(失败教训库)\n✅ 多场景兼容(IR-022)\n开始修复..."
        },
        "回复用户前检查清单": {
            "trigger_keywords": [
                "内部触发",
                "回复前检查"
            ],
            "check_items": [
                {
                    "id": "CHK-REPLY-001",
                    "rule_ref": "IR-001",
                    "question": "是否已经完成了任务，而不是停下来询问？",
                    "how_to_check": "任务是否100%完成，没有待确认项",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-REPLY-002",
                    "rule_ref": "IR-002",
                    "question": "遇到问题是否自己解决了，而不是问用户？",
                    "how_to_check": "是否有未解决的问题抛给用户",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-REPLY-003",
                    "rule_ref": "IR-003",
                    "question": "代码是否已经自己测试完成，无BUG？",
                    "how_to_check": "是否完成了完整的自测",
                    "violation_risk": "critical",
                    "must_pass": true
                },
                {
                    "id": "CHK-REPLY-004",
                    "rule_ref": "IR-014",
                    "question": "模块是否已经测试和注册？",
                    "how_to_check": "是否更新了模块注册表",
                    "violation_risk": "high",
                    "must_pass": true
                },
                {
                    "id": "CHK-REPLY-005",
                    "rule_ref": "对话刷新机制",
                    "question": "对话是否超过15轮或15000字？",
                    "how_to_check": "计算当前对话轮数和字符数",
                    "violation_risk": "medium",
                    "must_pass": false
                }
            ],
            "auto_remind_template": "回复前自查：\n✅ 任务已100%完成(IR-001)\n✅ 问题已自行解决(IR-002)\n✅ 代码已自测无BUG(IR-003)\n✅ 模块已测试注册(IR-014)\n可以回复用户了"
        }
    },
    "trigger_mechanism": {
        "description": "如何触发检查清单",
        "rules": [
            "1. 识别用户意图中的触发关键词",
            "2. 自动匹配对应的检查清单类型",
            "3. 在执行任务前，先执行检查清单",
            "4. 使用auto_remind_template主动告知用户",
            "5. 所有must_pass=true的项目必须通过",
            "6. 检查清单执行后才开始实际任务"
        ]
    },
    "violation_handling": {
        "critical": {
            "action": "🔴 阻断",
            "description": "不通过则不能继续执行任务",
            "examples": [
                "硬编码",
                "无限循环",
                "未自测就交付"
            ]
        },
        "high": {
            "action": "🟡 警告",
            "description": "强烈建议修正，记录违规次数",
            "examples": [
                "函数过长",
                "未查重复模块"
            ]
        },
        "medium": {
            "action": "🟢 提示",
            "description": "提醒注意，不阻断执行",
            "examples": [
                "注释风格",
                "命名规范"
            ]
        }
    },
    "execution_statistics": {
        "total_check_lists": 4,
        "total_check_items": 23,
        "critical_items": 8,
        "high_items": 10,
        "medium_items": 5,
        "expected_trigger_rate": "95%+",
        "expected_violation_reduction": "15-20% → 3-5%"
    }
}